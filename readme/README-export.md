Export
================

``` r
source("../setup.R")
```

Each dataset has it’s own export functionality (by year, month and
possibly both) which yields a wide-format table with a leading date
column. A single function, `export()` will export all of the datasets
into one table (by year or by month). These may be subsequently read
into R using the `read_export()` function. Below we select columns that
include “q75” (75th percentile) and filter for dates from 1950 until
recent. We standardize using the `scale` function which transforms each
variable to have a mean of 0 and a standard deviation of 1.

``` r
x = read_export(by = 'year', standardize = TRUE) |>
                dplyr::select(date, dplyr::contains("q25")) |>
                dplyr::filter(date >= as.Date("1950-01-01")) |>
  dplyr::glimpse()
```

    ## Rows: 73
    ## Columns: 49
    ## $ date                       <date> 1950-01-01, 1951-01-01, 1952-01-01, 1953-0…
    ## $ GHCN.USC00170100.PRCP.q25  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ GHCN.USC00171628.PRCP.q25  <dbl> NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN…
    ## $ GHCN.USC00190736.PRCP.q25  <dbl> NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN…
    ## $ GHCN.USC00272174.PRCP.q25  <dbl> -0.3909834, -0.3909834, -0.3909834, -0.3909…
    ## $ GHCN.USW00014764.PRCP.q25  <dbl> NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN…
    ## $ GHCN.USC00170100.SNOW.q25  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ GHCN.USC00171628.SNOW.q25  <dbl> NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN…
    ## $ GHCN.USC00190736.SNOW.q25  <dbl> NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN…
    ## $ GHCN.USC00272174.SNOW.q25  <dbl> -0.325568, -0.325568, -0.325568, -0.325568,…
    ## $ GHCN.USW00014764.SNOW.q25  <dbl> NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN…
    ## $ GHCN.USC00170100.SNWD.q25  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ GHCN.USC00171628.SNWD.q25  <dbl> NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN…
    ## $ GHCN.USC00190736.SNWD.q25  <dbl> -0.3881166, -0.3881166, -0.3881166, -0.3881…
    ## $ GHCN.USC00272174.SNWD.q25  <dbl> -0.5058057, -0.5058057, -0.5058057, -0.5058…
    ## $ GHCN.USW00014764.SNWD.q25  <dbl> NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN, NaN…
    ## $ GHCN.USC00170100.TMAX.q25  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ GHCN.USC00171628.TMAX.q25  <dbl> -0.2708023, 0.9996574, -0.2708023, 1.952502…
    ## $ GHCN.USC00190736.TMAX.q25  <dbl> 0.5783566, 1.9148539, 0.1852691, 2.3079413,…
    ## $ GHCN.USC00272174.TMAX.q25  <dbl> 0.42636144, 1.80480826, -0.46557473, 2.2102…
    ## $ GHCN.USW00014764.TMAX.q25  <dbl> 0.2068780, 0.8021058, 0.2068780, 2.9846078,…
    ## $ GHCN.USC00170100.TMIN.q25  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ GHCN.USC00171628.TMIN.q25  <dbl> -0.27777929, 0.27329295, 0.57387780, 1.6760…
    ## $ GHCN.USC00190736.TMIN.q25  <dbl> 0.2342967, 1.4070199, 0.7673527, 2.5797431,…
    ## $ GHCN.USC00272174.TMIN.q25  <dbl> -0.3468378, 1.1643840, 1.1643840, 2.1422334…
    ## $ GHCN.USW00014764.TMIN.q25  <dbl> -0.6725527, 0.3203156, 0.3203156, 0.8618802…
    ## $ USGS01021000.discharge.q25 <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 0.0…
    ## $ USGS01021480.discharge.q25 <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ USGS01022500.discharge.q25 <dbl> -0.9537476595, 1.7459393968, -0.9537476595,…
    ## $ USGS01022840.discharge.q25 <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ USGS01037380.discharge.q25 <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ USGS01059000.discharge.q25 <dbl> 0.081780771, 0.929326947, -0.780634636, -0.…
    ## $ USGS01069500.discharge.q25 <dbl> -0.85013804, 1.87753890, 1.12817710, -0.160…
    ## $ USGS01069700.discharge.q25 <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ amo.q25                    <dbl> NA, NA, NA, NA, 0.30098662, 0.92267584, -0.…
    ## $ nao.q25                    <dbl> NA, NA, NA, NA, 0.656287525, -0.907529863, …
    ## $ gsi.q25                    <dbl> NA, NA, NA, NA, 0.9342042, -0.1843843, -0.5…
    ## $ EaMeCoSh.sst.q25           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ GeorBnk.sst.q25            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ GeorBsn.sst.q25            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ JordBsn.sst.q25            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ WeCoSh.sst.q25             <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ WilkBsn.sst.q25            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ EaMeCoSh.chlor.q25         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ GeorBnk.chlor.q25          <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ GeorBsn.chlor.q25          <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ JordBsn.chlor.q25          <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ WeCoSh.chlor.q25           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ WilkBsn.chlor.q25          <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…

We can plot a heat map for the above.

``` r
plot_export(x, title = "Standardized Q25 by year")
```

![](README-export_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->
